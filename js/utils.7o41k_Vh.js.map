{"version":3,"file":"utils.7o41k_Vh.js","sources":["../../src/utils/file.ts","../../src/utils/dealRoute.ts","../../src/utils/general.ts","../../src/utils/menus.ts"],"sourcesContent":["export async function fileToFormData(file: File, pathName: string = \"file\") {\r\n  const formData = new FormData();\r\n  formData.append(pathName, file);\r\n  return formData;\r\n}\r\nexport function fileToBase64(file: File) {\r\n  return new Promise(\r\n    (\r\n      resolve: (value: {\r\n        state: \"success\" | \"fail\";\r\n        message?: string;\r\n        ext: string | undefined;\r\n        base64: string;\r\n      }) => void,\r\n      reject: (reason: {\r\n        state: \"fail\";\r\n        message: ProgressEvent<FileReader>;\r\n      }) => void\r\n    ) => {\r\n      const ext = file.name.split(\".\").pop();\r\n      const reader = new FileReader();\r\n      reader.onload = (e) => {\r\n        const uint8Array = new Uint8Array(e.target!.result as ArrayBuffer);\r\n        const str = uint8Array.reduce(\r\n          (data, byte) => data + String.fromCharCode(byte),\r\n          \"\"\r\n        );\r\n        const base64 = btoa(str);\r\n        resolve({\r\n          state: \"success\",\r\n          ext,\r\n          base64,\r\n        });\r\n      };\r\n      reader.onerror = (e) => {\r\n        reject({\r\n          state: \"fail\",\r\n          message: e,\r\n        });\r\n      };\r\n      reader.readAsArrayBuffer(file);\r\n    }\r\n  );\r\n}\r\nexport function fileToBinary(file: File) {\r\n  return new Promise(\r\n    (\r\n      resolve: (value: { state: \"success\"; binary: ArrayBuffer }) => void,\r\n      reject: (reason: {\r\n        state: \"fail\";\r\n        message: ProgressEvent<FileReader>;\r\n      }) => void\r\n    ) => {\r\n      const reader = new FileReader();\r\n      reader.onloadend = () => {\r\n        const binary = reader.result as ArrayBuffer;\r\n        resolve({\r\n          state: \"success\",\r\n          binary,\r\n        });\r\n      };\r\n      reader.onerror = (e) => {\r\n        reject({\r\n          state: \"fail\",\r\n          message: e,\r\n        });\r\n      };\r\n      reader.readAsArrayBuffer(file);\r\n    }\r\n  );\r\n}\r\n\r\nexport function downloadFile(file: File, fileName: string) {\r\n  const link = document.createElement(\"a\");\r\n  link.href = URL.createObjectURL(file);\r\n  link.download = fileName;\r\n  link.click();\r\n}\r\n","import { useRouter, useRoute } from \"vue-router\";\r\nconst routeModel = import.meta.env.VITE_ROUTER_MODEL;\r\nconst base = import.meta.env.VITE_BASE_PATH;\r\n// 跳转页面需要加上vite中的base配置的路径,结尾不带/\r\nconst routerPrefix = base.slice(0, -1) + (routeModel == \"hash\" ? \"/#\" : \"\");\r\ntype NavigateTo = ParamsUnion<ReturnType<typeof useRouter>[\"push\"]>;\r\n/***************************************************************************************************/\r\n/**\r\n * @class\r\n * @description 创建一个路由管理器\r\n */\r\nexport class CreateRouterManager {\r\n  router: ReturnType<typeof useRouter>;\r\n  route: ReturnType<typeof useRoute>;\r\n\r\n  constructor() {\r\n    this.router = useRouter();\r\n    this.route = useRoute();\r\n  }\r\n  navigateTo(to: NavigateTo) {\r\n    this.router.push(to);\r\n  }\r\n  goBack() {\r\n    this.router.back();\r\n  }\r\n  refresh() {}\r\n}\r\ntype Tab = {\r\n  path: string; //跳转的url\r\n  params?: {\r\n    [P: string]: any;\r\n  };\r\n};\r\n/***************************************************************************************************/\r\n/**\r\n * @class\r\n *@description 创建一个打开新标签页的实例\r\n */\r\nexport class CreateTabPage {\r\n  readonly tabName: string;\r\n  route: ReturnType<typeof useRoute>;\r\n  constructor(tabName: string) {\r\n    this.tabName = tabName;\r\n    this.route = useRoute();\r\n  }\r\n  openTab(to: Tab) {\r\n    if (to.path.startsWith(\"/\")) {\r\n      // to.path = to.path.slice(1);\r\n      // 将params中的参数都拼接到url上\r\n      to.path = to.path + objTOPath(to.params || {});\r\n      // 路由模式为hash则拼接/#/字符串，否则拼接空字符串\r\n      to.path = routerPrefix + to.path;\r\n    }\r\n    // return;\r\n    window.open(to.path, this.tabName);\r\n  }\r\n  getParams() {\r\n    console.log(\"window.location,csRouter\", window.location, this.route);\r\n    const params = Object.assign(this.route.params, this.route.query);\r\n    return params;\r\n  }\r\n  closeTab() {\r\n    window.close();\r\n  }\r\n}\r\n/***************************************************************************************************/\r\n/**\r\n * @description 将data转换为键值对字符串,返回值不为空在前面加一个?,为空就返回空字符串\r\n * @param  data 任意对象\r\n * @returns {string} 键值对字符串\r\n */\r\nfunction objTOPath<T extends object>(data: T): string {\r\n  // 如果data对象不存在或者data中没有属性就返回空字符串\r\n  if (!Object.keys(data).length) return \"\";\r\n  let arr: string[] = [];\r\n  let char = \"\";\r\n  for (const key in data) {\r\n    arr.push(`${key}=${data[key]}`);\r\n  }\r\n  char = arr.join(\"&\");\r\n  // 有参数就返回?+char,无参数就返回char\r\n  return char && \"?\" + char;\r\n}\r\n","/**\r\n * @name 节流\r\n * @param {Function} callback 要执行的回调函数\r\n * @param {Number} delay 延迟时间\r\n * @param {Boolean} isImmediate 是否立即执行回调函数\r\n * @returns {Function}\r\n */\r\ntype Func = (...args: any[]) => void;\r\n\r\nexport function throttle<T extends Func>(\r\n  callback: T,\r\n  delay: number = 1000,\r\n  isImmediate: boolean = false\r\n) {\r\n  let timer: number | undefined = undefined;\r\n  return function (this: any, ...args: Parameters<T>) {\r\n    if (timer) return;\r\n    if (!isImmediate) return callback.apply(this, args);\r\n    timer = setTimeout(() => {\r\n      clearTimeout(timer);\r\n      timer = undefined;\r\n      if (isImmediate) callback.apply(this, args);\r\n    }, delay);\r\n  } as T;\r\n}\r\n/**\r\n * @name 防抖\r\n * @description 只有最后一次触发才执行\r\n * @param {Function}callback  要执行的回调函数\r\n * @param {Number}interval 触发间隔\r\n * @returns\r\n */\r\nexport function debounce<T extends Func>(\r\n  callback: T,\r\n  interval: number = 1000\r\n): T {\r\n  let timer: number | undefined = undefined;\r\n  return function (this: any, ...args: Parameters<T>) {\r\n    clearTimeout(timer);\r\n    timer = setTimeout(() => {\r\n      callback.apply(this, args);\r\n    }, interval);\r\n  } as T;\r\n}\r\ntype FieldType =\r\n  | \"number\"\r\n  | \"string\"\r\n  | \"undefined\"\r\n  | \"null\"\r\n  | \"object\"\r\n  | \"array\"\r\n  | \"function\"\r\n  | \"date\"\r\n  | \"regexp\"\r\n  | \"bigint\"\r\n  | \"symbol\";\r\n/**\r\n * @name 变量类型\r\n * @description: 检测变量的类型\r\n * @param {any} field  要检测的类型\r\n * @return {FieldType}\r\n */\r\nexport function varType(field: any): FieldType {\r\n  return Object.prototype.toString\r\n    .call(field)\r\n    .slice(8, -1)\r\n    .toLowerCase() as FieldType;\r\n}\r\nexport function setCache(key: string, value: any) {\r\n  window.addEventListener(\"beforeunload\", () => {\r\n    localStorage.setItem(key, JSON.stringify(value));\r\n  });\r\n}\r\nexport function getCache(key: string) {\r\n  const cache = localStorage.getItem(key);\r\n  if (cache) {\r\n    return JSON.parse(cache);\r\n  }\r\n  return null;\r\n}\r\n","import type { CustomRouteRecordRaw } from \"@/types/router\";\r\nimport type { ExMenuItemType } from \"@/types/store\";\r\n// 项目菜单配\r\nexport function getAllMenus(list: CustomRouteRecordRaw[]) {\r\n  const allMenus: ExMenuItemType[] = list.map((item) => {\r\n    return {\r\n      index: item.name as string,\r\n      title: item.labelName,\r\n      isHidden: item.isHidden || false,\r\n      children: item.children ? getAllMenus(item.children) : [],\r\n    };\r\n  });\r\n  return allMenus;\r\n}\r\nexport function getTopMenus(list: ExMenuItemType[]): ExMenuItemType[] {\r\n  return list\r\n    .filter((item) => !item.isHidden)\r\n    .map((item) => {\r\n      return {\r\n        index: item.index,\r\n        title: item.title,\r\n        isHidden: item.isHidden,\r\n        // children: item.children ? getTopMenus(item.children) : [],\r\n      };\r\n    });\r\n}\r\nexport function getSIdeMenus(\r\n  list: ExMenuItemType[],\r\n  activeIndex?: string\r\n): ExMenuItemType[] {\r\n  let obj: ExMenuItemType | undefined;\r\n  if (activeIndex) {\r\n    obj = list.find((item) => item.index === activeIndex);\r\n    list = obj?.children || [];\r\n  }\r\n  const sideMenus = list\r\n    .filter((item) => !item.isHidden)\r\n    .map((item) => {\r\n      return {\r\n        index: item.index,\r\n        title: item.title,\r\n        isHidden: item.isHidden,\r\n        children: item.children ? getSIdeMenus(item.children) : [],\r\n      };\r\n    });\r\n  return sideMenus;\r\n}\r\n"],"names":["fileToFormData","file","pathName","formData","fileToBase64","resolve","reject","ext","reader","e","str","data","byte","base64","fileToBinary","binary","base","routerPrefix","CreateRouterManager","__publicField","useRouter","useRoute","to","CreateTabPage","tabName","objTOPath","arr","char","key","throttle","callback","delay","isImmediate","timer","args","getAllMenus","list","item","getTopMenus","getSIdeMenus","activeIndex","obj"],"mappings":"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"}